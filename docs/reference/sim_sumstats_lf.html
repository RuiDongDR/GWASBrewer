<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Simulate summary statistics from a specified factor structure"><title>Simulate summary statistics — sim_sumstats_lf • simGWAS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate summary statistics — sim_sumstats_lf"><meta property="og:description" content="Simulate summary statistics from a specified factor structure"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">simGWAS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.0037</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/simulating_data.html">Simulating Data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jean997/simGWAS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulate summary statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/jean997/simGWAS/blob/HEAD/R/sim_sumstats_lf.R" class="external-link"><code>R/sim_sumstats_lf.R</code></a></small>
      <div class="d-none name"><code>sim_sumstats_lf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate summary statistics from a specified factor structure</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim_sumstats_lf</span><span class="op">(</span></span>
<span>  <span class="va">F_mat</span>,</span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">J</span>,</span>
<span>  <span class="va">h2_trait</span>,</span>
<span>  <span class="va">omega</span>,</span>
<span>  <span class="va">h2_factor</span>,</span>
<span>  <span class="va">pi_L</span>,</span>
<span>  <span class="va">pi_theta</span>,</span>
<span>  R_E <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  af <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R_LD <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  snp_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sporadic_pleiotropy <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>F_mat</dt>
<dd><p>factor matrix M by K (M = number of traits, K = number of factors)</p></dd>


<dt>N</dt>
<dd><p>GWAS sample size. N can be a scalar, vector, or matrix. If N is a scalar, all GWAS have the same sample size
and there is no overlap between studies. If N is a vector, each element of N specifies the sample size of the corresponding
GWAS and there is no overlap between studies. If N is a matrix, N_ii specifies the sample size of study i
and N_ij specifies the number of samples present in both study i and study j. The elements of N must be positive
but non-integer values will not generate an error.</p></dd>


<dt>J</dt>
<dd><p>Total number of SNPs to generate</p></dd>


<dt>h2_trait</dt>
<dd><p>Heritability of each trait. Length M vector.</p></dd>


<dt>omega</dt>
<dd><p>Proportion of trait heritability mediated by factors. Length M vector.</p></dd>


<dt>h2_factor</dt>
<dd><p>Heritability of each factor. Length K vector.</p></dd>


<dt>pi_L</dt>
<dd><p>Proportion of non-zero elements in L_k. Length K factor</p></dd>


<dt>pi_theta</dt>
<dd><p>Proportion of non-zero elements in theta. Scalar or length M vector.</p></dd>


<dt>R_E</dt>
<dd><p>Correlation between environmental trait components not mediated by factors. M by M pd matrix.</p></dd>


<dt>af</dt>
<dd><p>Allele frequency (optional). A scalar, a vector, or a function that takes a number n and returns n values between 0 and 1.
This argument is ignored if R_LD and snp_info are provided. If af, R_LD, and snp_info
are all missing, SNPs are assumed to be scaled to variance 1,</p></dd>


<dt>R_LD</dt>
<dd><p>List of eigen-decompositions of LD correlation matrices, may be missing.</p></dd>


<dt>snp_info</dt>
<dd><p>If R_LD is provided, provide a data frame with columns "SNP" and "AF"</p></dd>


<dt>sporadic_pleiotropy</dt>
<dd><p>Allow a single SNP to affect multiple factors (default TRUE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function will generate GWAS summary statistics for M traits with K common factors.
The matrix F_mat provides the effects of each factor on each trait, <code>F_mat[i,j]</code>
gives the effect of factor j on trait i. The rows of <code>F_mat</code> will be scaled in order
to provide desired proportion of hertiability of each trait explained by factors but the relative
size and sign of elements within rows will be retained.</p>
<p>Previously, if F_mat was not provided, a random factor matrix would be generated.
In the current version, this step must be done manually, see examples.</p>
<p>With these parameters, it is possible to supply a non-feasible set of parameters.
Usually this occurs if the heritability of the factors is low but the heritability
of the traits is high leading to a contradiction. The function will return an error if this happens.</p>
<p>Trait covariance: Each trait is composed of four independent components, the genetic component mediated by factors,
the environmental component mediated by factors, the genetic component not mediated by factors,
and the environmental component not mediated by factors. Therefore, the total trait covariance can be decomposed into
the sum of four corresponding covariance matrices. The matrix R_E specifies the correlation of the last component only.
In the returned object, R gives the overall trait correlation matrix multiplied by the overlap proportion matrix,
which is equal to the correlation in the error terms of <code>beta_hat</code> (see examples).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">myF</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_random_F.html">generate_random_F</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">3</span>, M <span class="op">=</span> <span class="fl">10</span>, nz_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">10</span><span class="op">)</span>, h2_trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">10</span><span class="op">)</span>, pad <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_sumstats_lf</span><span class="op">(</span><span class="va">myF</span>, N <span class="op">=</span> <span class="fl">10000</span>, J <span class="op">=</span> <span class="fl">20000</span>, h2_trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">10</span><span class="op">)</span>, pi_L <span class="op">=</span> <span class="fl">0.1</span>, pi_theta <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> SNP effects provided for 20000 SNPs and 10 traits.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">myF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">8000</span>, <span class="fl">8000</span>, <span class="fl">10000</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">R_E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sim_sumstats_lf</span><span class="op">(</span>F_mat <span class="op">=</span> <span class="va">myF</span>, N <span class="op">=</span> <span class="va">N</span>, J <span class="op">=</span> <span class="fl">20000</span>, h2_trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">2</span><span class="op">)</span>, omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, h2_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       pi_L <span class="op">=</span> <span class="fl">0.1</span>, pi_theta <span class="op">=</span> <span class="fl">0.1</span>, R_E <span class="op">=</span> <span class="va">R_E</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> SNP effects provided for 20000 SNPs and 2 traits.</span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">R</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]  [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.000 0.192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.192 1.000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">beta_hat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">dat</span><span class="op">$</span><span class="va">beta_joint</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">dat</span><span class="op">$</span><span class="va">beta_hat</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">dat</span><span class="op">$</span><span class="va">beta_joint</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1938121</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jean Morrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

